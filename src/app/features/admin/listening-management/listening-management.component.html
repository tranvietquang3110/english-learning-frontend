<div class="p-6">
  <!-- Header -->
  <div class="flex justify-between items-center mb-6">
    <div>
      <h1 class="text-3xl font-bold">Listening Management</h1>
      <p class="text-muted-foreground">Manage listening topics and exercises</p>
    </div>
    <div class="flex gap-3">
      <button
        *ngIf="currentState === State.View"
        (click)="changeToCreate()"
        class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90"
      >
        Tạo topic mới
      </button>
      <app-ai-button (click)="isShowTopicGenerate = true"
        >Topic Generate</app-ai-button
      >
    </div>
  </div>

  <!-- View State -->
  <div
    *ngIf="currentState === State.View"
    class="mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"
  >
    @for (topic of topics; track $index) {
    <app-topic-card
      (edit)="changeToEdit($event)"
      (detail)="onViewDetail($event)"
      (delete)="onDelete($event)"
      [topic]="topic"
    ></app-topic-card>
    }
  </div>

  <div class="mt-8" *ngIf="currentState === State.View">
    <app-pagination
      [currentPage]="currentPage"
      [totalPages]="totalPages"
      (pageChange)="onPageChange($event)"
    ></app-pagination>
  </div>
  <!-- Create State -->
  <div *ngIf="currentState === State.Create">
    <app-listening-topic-form
      (submit)="onCreateTopic($event)"
      (cancel)="onCancel()"
    ></app-listening-topic-form>
  </div>

  <div *ngIf="currentState === State.Edit">
    <app-listening-topic-form
      [initialData]="currentTopic"
      (submit)="onEditTopic($event)"
      (cancel)="onCancel()"
    ></app-listening-topic-form>
  </div>
</div>
<app-confirm-dialog
  [isVisible]="isShowConfirmDialog"
  title="Xóa topic"
  message="Bạn có chắc chắn muốn xóa topic này? Hành động này không thể hoàn tác."
  confirmText="Xóa"
  cancelText="Hủy"
  confirmButtonClass="form-button-danger"
  cancelButtonClass="form-button-secondary"
  (confirm)="confirmDelete()"
  (cancel)="onCancelDelete()"
></app-confirm-dialog>

<app-topic-generate
  *ngIf="isShowTopicGenerate"
  (closed)="isShowTopicGenerate = false"
  [isOpen]="isShowTopicGenerate"
  [topicType]="'Listening'"
  (submitted)="onSubmitTestGenerate($event)"
></app-topic-generate>
