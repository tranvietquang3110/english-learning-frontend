<div class="upload-container">
  <!-- Header -->
  <div class="header" *ngIf="title || description">
    <h2 class="title" *ngIf="title">{{ title }}</h2>
    <p class="description" *ngIf="description">{{ description }}</p>
  </div>
  <div *ngIf="excelTemplate">
    <p class="text-sm text-gray-500">Mẫu file Excel:</p>
    <pre class="text-sm text-gray-500">{{ excelTemplate }}</pre>
  </div>
  <!-- Excel File Upload -->
  <div class="upload-section">
    <label class="upload-label">
      <span class="label-text">File Excel <span class="required">*</span></span>
      <span class="label-hint">Chọn file Excel để cập nhật dữ liệu</span>
    </label>
    <div class="file-input-wrapper">
      <input
        type="file"
        accept=".xlsx,.xls,.csv"
        (change)="onExcelFileSelected($event)"
        class="file-input"
        id="excel-file"
        title="Chọn file Excel"
        aria-label="Chọn file Excel"
      />
      <label for="excel-file" class="file-input-label">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="icon"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"
          />
        </svg>
        <span>Chọn file Excel</span>
      </label>
    </div>

    <!-- Excel File Preview -->
    <div *ngIf="excelFile" class="file-preview">
      <div class="file-info">
        <div class="file-icon excel-icon">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"
            />
          </svg>
        </div>
        <div class="file-details">
          <p class="file-name">{{ excelFile.name }}</p>
          <p class="file-size">{{ formatFileSize(excelFile.size) }}</p>
        </div>
        <button
          type="button"
          (click)="removeExcelFile()"
          class="remove-btn"
          aria-label="Xóa file Excel"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M6 18L18 6M6 6l12 12"
            />
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Image Files Upload -->
  <div class="upload-section" *ngIf="isContainsImage">
    <label class="upload-label">
      <span class="label-text">File ảnh</span>
      <span class="label-hint"
        >Chọn một hoặc nhiều file ảnh (có thể chọn nhiều)</span
      >
    </label>
    <div class="file-input-wrapper">
      <input
        type="file"
        accept="image/*"
        (change)="onImageFilesSelected($event)"
        class="file-input"
        id="image-files"
        multiple
        title="Chọn file ảnh"
        aria-label="Chọn file ảnh"
      />
      <label for="image-files" class="file-input-label">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="icon"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-6.364-6.364l2.909-2.909a2.25 2.25 0 013.182 0l2.909 2.909m-6.364-6.364l-5.159 5.159m0 0V21M4.5 4.5h15"
          />
        </svg>
        <span>Chọn file ảnh</span>
      </label>
    </div>

    <!-- Image Files Preview -->
    <div *ngIf="imageFiles.length > 0" class="files-preview">
      <div
        *ngFor="let imageFile of imageFiles; let i = index"
        class="file-preview image-preview"
      >
        <div class="image-thumbnail">
          <img
            [src]="imagePreviewUrls[i]"
            alt="Preview image"
            [title]="imageFile.name"
          />
        </div>
        <div class="file-info">
          <div class="file-details">
            <p class="file-name">{{ imageFile.name }}</p>
            <p class="file-size">{{ formatFileSize(imageFile.size) }}</p>
          </div>
          <button
            type="button"
            (click)="removeImageFile(i)"
            class="remove-btn"
            [attr.aria-label]="'Xóa ảnh ' + imageFile.name"
            [title]="'Xóa ảnh ' + imageFile.name"
          >
            <span class="sr-only">Xóa ảnh {{ imageFile.name }}</span>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M6 18L18 6M6 6l12 12"
              />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Audio Files Upload -->
  <div class="upload-section" *ngIf="isContainsAudio">
    <label class="upload-label">
      <span class="label-text">File audio</span>
      <span class="label-hint"
        >Chọn một hoặc nhiều file audio (có thể chọn nhiều)</span
      >
    </label>
    <div class="file-input-wrapper">
      <input
        type="file"
        accept="audio/*"
        (change)="onAudioFilesSelected($event)"
        class="file-input"
        id="audio-files"
        multiple
        title="Chọn file audio"
        aria-label="Chọn file audio"
      />
      <label for="audio-files" class="file-input-label">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="icon"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M9 9l10.5-3m0 6.553v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 11-.99-3.467l2.31-.66a2.25 2.25 0 001.632-2.163zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 01-.99-3.467l2.31-.66A2.25 2.25 0 009 15.553z"
          />
        </svg>
        <span>Chọn file audio</span>
      </label>
    </div>

    <!-- Audio Files Preview -->
    <div *ngIf="audioFiles.length > 0" class="files-preview">
      <div
        *ngFor="let audioFile of audioFiles; let i = index"
        class="file-preview audio-preview"
      >
        <div class="file-icon audio-icon">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M9 9l10.5-3m0 6.553v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 11-.99-3.467l2.31-.66a2.25 2.25 0 001.632-2.163zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 01-1.632 2.163l-1.32.377a1.803 1.803 0 01-.99-3.467l2.31-.66A2.25 2.25 0 009 15.553z"
            />
          </svg>
        </div>
        <div class="file-info">
          <div class="file-details">
            <p class="file-name">{{ audioFile.name }}</p>
            <p class="file-size">{{ formatFileSize(audioFile.size) }}</p>
          </div>
          <button
            type="button"
            (click)="removeAudioFile(i)"
            class="remove-btn"
            [attr.aria-label]="'Xóa audio ' + audioFile.name"
            [title]="'Xóa audio ' + audioFile.name"
          >
            <span class="sr-only">Xóa audio {{ audioFile.name }}</span>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M6 18L18 6M6 6l12 12"
              />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Upload Button -->
  <div class="actions">
    <button
      type="button"
      (click)="onUploadFile()"
      class="upload-btn"
      [disabled]="!excelFile || isLoading"
    >
      <span *ngIf="isLoading" class="loading-spinner"></span>
      <span *ngIf="!isLoading">Tải lên</span>
      <span *ngIf="isLoading">Đang tải lên...</span>
    </button>
    <button
      type="button"
      (click)="resetFiles()"
      class="reset-btn"
      [disabled]="isLoading"
    >
      Xóa tất cả
    </button>
  </div>
</div>
