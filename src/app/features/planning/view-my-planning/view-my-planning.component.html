<div class="min-h-full bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 p-6 planning-container">
  <!-- Header -->
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-2xl font-bold text-slate-800 dark:text-white">K·∫ø ho·∫°ch h·ªçc t·∫≠p c·ªßa t√¥i</h1>
    <div class="flex gap-3">
      <app-ai-button (click)="showAIPlanningModal = true">
        AI Planning
      </app-ai-button>
      <button
        class="bg-primary text-white px-4 py-2 rounded-lg hover:opacity-80 transition-colors"
        routerLink="/planning/create"
      >
        T·∫°o k·∫ø ho·∫°ch m·ªõi
      </button>
      <button
        (click)="loadPlans(currentPage - 1)"
        class="bg-gray-100 dark:bg-slate-700 hover:bg-gray-200 dark:hover:bg-slate-600 text-gray-700 dark:text-slate-300 px-4 py-2 rounded-lg transition-colors"
      >
        L√†m m·ªõi
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="text-center py-12">
    <div
      class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary loading-spinner"
    ></div>
    <p class="text-slate-600 dark:text-slate-300 mt-2">ƒêang t·∫£i danh s√°ch k·∫ø ho·∫°ch...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !isLoading" class="text-center py-12">
    <div class="text-red-400 text-6xl mb-4">‚ö†Ô∏è</div>
    <h3 class="text-xl font-semibold text-red-600 dark:text-red-400 mb-2">C√≥ l·ªói x·∫£y ra</h3>
    <p class="text-red-500 dark:text-red-400 mb-4">{{ error }}</p>
    <button
      (click)="loadPlans(currentPage - 1)"
      class="bg-primary text-white px-6 py-2 rounded-lg hover:opacity-80"
    >
      Th·ª≠ l·∫°i
    </button>
  </div>

  <!-- Plans Table -->
  <div *ngIf="!isLoading && !error" class="bg-white dark:bg-slate-800 rounded-lg shadow-md border border-slate-200 dark:border-slate-700">
    <div class="p-6 border-b border-slate-200 dark:border-slate-700">
      <h2 class="text-lg font-semibold text-slate-800 dark:text-white">Danh s√°ch k·∫ø ho·∫°ch</h2>
      <p class="text-slate-600 dark:text-slate-300 text-sm mt-1">
        T·ªïng c·ªông: {{ plans.length }} k·∫ø ho·∫°ch
      </p>
    </div>

    <div class="p-6">
      <!-- Plans Table -->
      <div *ngIf="plans.length > 0" class="overflow-x-auto">
        <table class="w-full">
          <thead>
            <tr class="border-b border-slate-200 dark:border-slate-700">
              <th class="text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300">
                T√™n k·∫ø ho·∫°ch
              </th>
              <th class="text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300">
                M√¥ t·∫£
              </th>
              <th class="text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300">
                Th·ªùi gian
              </th>
              <th class="text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300">
                M·ª•c ti√™u
              </th>
              <th class="text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300">
                Ti·∫øn ƒë·ªô
              </th>
              <th class="text-left py-3 px-4 font-semibold text-slate-700 dark:text-slate-300">
                Tr·∫°ng th√°i
              </th>
              <th class="text-center py-3 px-4 font-semibold text-slate-700 dark:text-slate-300">
                Thao t√°c
              </th>
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="let plan of plans"
              class="border-b border-slate-100 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors"
            >
              <td class="py-4 px-4">
                <div class="font-medium text-slate-800 dark:text-white">{{ plan.title }}</div>
                <div class="text-sm text-slate-500 dark:text-slate-400">ID: {{ plan.id }}</div>
              </td>
              <td class="py-4 px-4">
                <div
                  class="text-slate-600 dark:text-slate-300 max-w-xs truncate"
                  [title]="plan.description"
                >
                  {{ plan.description }}
                </div>
              </td>
              <td class="py-4 px-4 text-slate-600 dark:text-slate-300">
                <div class="text-sm">
                  <div>T·ª´: {{ formatDate(plan.startDate) }}</div>
                  <div>ƒê·∫øn: {{ formatDate(plan.endDate) }}</div>
                </div>
              </td>
              <td class="py-4 px-4 text-slate-600 dark:text-slate-300">
                <div class="text-center">
                  <span class="text-lg font-semibold text-blue-600 dark:text-blue-400">{{
                    plan.target
                  }}</span>
                  <div class="text-xs text-slate-500 dark:text-slate-400">ƒëi·ªÉm</div>
                </div>
              </td>
              <td class="py-4 px-4">
                <div class="w-full bg-gray-200 dark:bg-slate-700 rounded-full h-2">
                  <div
                    class="bg-blue-600 dark:bg-blue-500 h-2 rounded-full transition-all duration-300"
                    [style.width.%]="getProgressPercentage(plan)"
                  ></div>
                </div>
                <div class="text-xs text-slate-500 dark:text-slate-400 mt-1">
                  {{ getProgressPercentage(plan) | number : "1.0-0" }}%
                </div>
              </td>
              <td class="py-4 px-4">
                <span
                  class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                  [class]="
                    getStatusBackgroundColor(plan.isCompleted) +
                    ' ' +
                    getStatusColor(plan.isCompleted)
                  "
                >
                  {{ getStatusLabel(plan.isCompleted) }}
                </span>
              </td>
              <td class="py-4 px-4">
                <div class="flex justify-center gap-2">
                  <button
                    (click)="onViewPlan(plan)"
                    class="bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-1 rounded text-sm transition-colors"
                    title="Xem chi ti·∫øt"
                    aria-label="Xem chi ti·∫øt"
                  >
                    <i class="fas fa-eye"></i>
                    Xem chi ti·∫øt
                  </button>
                  <button
                    (click)="onEditPlan(plan)"
                    class="bg-yellow-100 hover:bg-yellow-200 text-yellow-700 px-3 py-1 rounded text-sm transition-colors"
                    title="Ch·ªânh s·ª≠a"
                    aria-label="Ch·ªânh s·ª≠a"
                  >
                    <i class="fas fa-edit"></i>
                    Ch·ªânh s·ª≠a
                  </button>
                  <button
                    (click)="onDeletePlan(plan)"
                    class="bg-red-100 hover:bg-red-200 text-red-700 px-3 py-1 rounded text-sm transition-colors"
                    title="X√≥a"
                    aria-label="X√≥a"
                  >
                    <i class="fas fa-trash"></i>
                    X√≥a
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Empty State -->
      <div *ngIf="plans.length === 0" class="text-center py-12">
        <div class="text-slate-400 dark:text-slate-500 text-6xl mb-4">üìã</div>
        <h3 class="text-xl font-semibold text-slate-600 dark:text-slate-300 mb-2">
          Ch∆∞a c√≥ k·∫ø ho·∫°ch n√†o
        </h3>
        <p class="text-slate-500 dark:text-slate-400 mb-4">
          H√£y t·∫°o k·∫ø ho·∫°ch h·ªçc t·∫≠p ƒë·∫ßu ti√™n ƒë·ªÉ b·∫Øt ƒë·∫ßu h√†nh tr√¨nh h·ªçc ti·∫øng Anh
          c·ªßa b·∫°n.
        </p>
        <button
          class="bg-primary text-white px-6 py-2 rounded-lg hover:opacity-80"
          routerLink="/planning/create"
        >
          T·∫°o k·∫ø ho·∫°ch m·ªõi
        </button>
      </div>

      <!-- Pagination -->
      <div *ngIf="totalPages > 1" class="mt-6">
        <app-pagination
          [currentPage]="currentPage"
          [totalPages]="totalPages"
          (pageChange)="handlePageChange($event)"
        ></app-pagination>
      </div>
    </div>
  </div>
</div>
<app-ai-planning-modal
  [isOpen]="showAIPlanningModal"
  [isLoading]="isLoading"
  (onClose)="showAIPlanningModal = false"
  (onGenerate)="handleGenerate($event)"
></app-ai-planning-modal>
