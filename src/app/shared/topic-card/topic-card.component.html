<div
  class="group cursor-pointer hover:shadow-lg transition-all duration-200 hover:-translate-y-1 relative overflow-hidden rounded-xl border bg-card text-card-foreground"
>
  <!-- Favorite Button -->
  <button
    *ngIf="favorite.observers.length > 0"
    class="absolute top-3 right-3 z-10 p-2 rounded-full bg-white/80 backdrop-blur-sm hover:bg-white transition-all duration-200 shadow-sm"
    (click)="toggleFavorite($event)"
    [title]="isFavorite ? 'Bỏ yêu thích' : 'Thêm vào yêu thích'"
  >
    <fa-icon
      [icon]="isFavorite ? faHeartSolid : faHeartRegular"
      [class]="isFavorite ? 'text-red-500' : 'text-gray-400 hover:text-red-500'"
      class="w-4 h-4 transition-colors duration-200"
    ></fa-icon>
  </button>

  <div class="p-6">
    <div class="space-y-4">
      <!-- Image -->
      <div
        class="aspect-square w-24 h-24 mx-auto bg-muted rounded-lg flex items-center justify-center overflow-hidden"
      >
        <img
          [src]="topic.imageUrl || '/placeholder.svg'"
          [alt]="topic.name"
          class="w-full h-full object-cover"
        />
      </div>

      <!-- Title + desc -->
      <div class="text-center space-y-2">
        <h3 class="font-semibold text-lg">{{ topic.name }}</h3>
        <p class="text-sm text-muted-foreground">
          {{ topic.description }}
        </p>
      </div>

      <!-- Badge + progress -->
      <div class="flex items-center justify-between">
        <span
          class="px-2.5 py-1 rounded-full text-xs"
          [ngClass]="badgeClass(topic.status)"
        >
          {{ topic.level?.toString() }}
        </span>

        <div class="flex items-center gap-2">
          <div class="w-16 h-2 bg-muted rounded-full overflow-hidden">
            <div
              class="h-full bg-primary transition-all duration-300"
              [style.width.%]="topic.progress || 0"
            ></div>
          </div>
          <span class="text-xs text-muted-foreground">
            {{ topic.progress }}%
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Hover overlay actions -->
  <div
    class="absolute inset-0 opacity-0 group-hover:opacity-100 transition-all duration-200 flex items-center justify-center"
    [ngStyle]="{
      'background-image': 'url(' + topic.imageUrl + ')',
      'background-size': 'cover',
      'background-position': 'center'
    }"
  >
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm"></div>

    <div class="relative space-y-3 w-4/5 max-w-xs">
      <button
        *ngIf="learn.observers.length > 0"
        class="w-full inline-flex items-center justify-center gap-2 rounded-md px-4 py-2 bg-primary text-primary-foreground hover:bg-primary/90"
        (click)="onLearn($event)"
      >
        <fa-icon [icon]="faBookOpen" class="w-4 h-4"></fa-icon>
        Học chủ đề này
      </button>

      <button
        *ngIf="test.observers.length > 0"
        class="w-full inline-flex items-center justify-center gap-2 rounded-md px-4 py-2 border border-primary text-primary hover:bg-primary hover:text-primary-foreground bg-transparent"
        (click)="onTest($event)"
      >
        <fa-icon [icon]="faFileAlt" class="w-4 h-4"></fa-icon>
        Làm bài test
      </button>

      <!-- Xem chi tiết -->
      <button
        *ngIf="detail.observers.length > 0"
        class="w-full inline-flex items-center justify-center gap-2 rounded-md px-4 py-2 border border-primary text-primary hover:bg-primary hover:text-primary-foreground bg-transparent"
        (click)="onDetail($event)"
      >
        <fa-icon [icon]="faEye" class="w-4 h-4"></fa-icon>
        Xem chi tiết
      </button>
    </div>
  </div>
</div>
